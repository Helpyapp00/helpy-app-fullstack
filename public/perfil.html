<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/perfil.css">
</head>
<body>
    
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>

    <header>
        <div class="logo-box">
            <img src="imagens/helpy-feed.png" alt="Logo Helpy"> <h1>Helpy</h1>
        </div>
        
        <div class="user-info">
            <img id="user-avatar-header" src="imagens/default-user.png" alt="Avatar" class="user-avatar-header">
            <span id="user-name-header">Carregando...</span>
            
            <button id="feed-button" title="Voltar ao Feed">
                <i class="fas fa-home"></i>
            </button>
            <button id="logout-button">Sair</button>
        </div>
    </header>

    <div class="content-perfil">
        <div class="perfil-card">
            <div class="perfil-header">
                <img id="fotoPerfil" class="perfil-img" src="imagens/default-user.png" alt="User Profile Image">
                
                <label id="labelInputFotoPerfil" class="label-input-foto oculto">
                    <i class="fas fa-camera"></i> Alterar Foto
                    <input type="file" id="inputFotoPerfil" accept="image/*">
                </label>

                <h2 id="nomePerfil">Carregando...</h2>
                <input type="text" id="inputNome" class="input-edicao oculto" placeholder="Nome Completo">
                
                <div id="media-avaliacao-container">
                    <span id="mediaEstrelas" class="media-avaliacao"></span>
                    <span id="totalAvaliacoes" class="total-avaliacoes"></span>
                </div>
                <!-- üÜï NOVO: Gamifica√ß√£o - N√≠vel (vis√≠vel para todos) -->
                <div id="nivel-container" class="nivel-container" style="display: none;">
                    <div class="nivel-badge">
                        <span class="selo-nivel">üõ°Ô∏è</span> N√≠vel <span id="nivelUsuario">1</span>
                    </div>
                </div>
                <!-- üÜï NOVO: XP (s√≥ para dono do perfil) -->
                <div id="gamificacao-container" class="gamificacao-container" style="display: none;">
                    <div class="xp-bar-container">
                        <div class="xp-info">
                            <span>XP: <span id="xpAtual">0</span> / <span id="xpProximo">100</span></span>
                        </div>
                        <div class="xp-bar">
                            <div id="xp-bar-fill" class="xp-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="perfil-body">
                <h3>Informa√ß√µes Pessoais</h3>
                <ul class="perfil-info">
                    <li id="email-item">
                        <i class="fas fa-envelope"></i> <a id="emailPerfil" href="#">...</a>
                        <input type="email" id="inputEmail" class="input-edicao oculto" placeholder="Email (n√£o pode ser alterado)" disabled>
                    </li>
                    <li id="idade-item">
                        <i class="fas fa-calendar-alt"></i> <span id="idadePerfil">...</span>
                        <input type="number" id="inputIdade" class="input-edicao oculto" placeholder="Idade (anos)">
                    </li>
                    <li id="telefone-item">
                        <i class="fas fa-phone"></i> <a id="telefonePerfil" href="#">...</a>
                        <input type="tel" id="inputWhatsapp" class="input-edicao oculto" placeholder="(XX) XXXXX-XXXX">
                    </li>
                    <li id="atuacao-item" style="display: none;">
                        <i class="fas fa-briefcase"></i> <span id="atuacaoPerfil">...</span>
                        <input type="text" id="inputAtuacao" class="input-edicao oculto" placeholder="√Årea de Atua√ß√£o">
                    </li>
                    
                    <!-- üõë ATUALIZA√á√ÉO: Cidade e Estado juntos -->
                    <li id="localizacao-item">
                        <i class="fas fa-map-marker-alt"></i> <span id="localizacaoPerfil">...</span>
                        <div class="input-edicao oculto">
                            <input type="text" id="inputCidade" placeholder="Sua Cidade">
                            <span style="color: var(--text-secondary);">-</span>
                            <select id="inputEstado">
                                <option value="">Estado</option>
                                <option value="AC">AC</option>
                                <option value="AL">AL</option>
                                <option value="AP">AP</option>
                                <option value="AM">AM</option>
                                <option value="BA">BA</option>
                                <option value="CE">CE</option>
                                <option value="DF">DF</option>
                                <option value="ES">ES</option>
                                <option value="GO">GO</option>
                                <option value="MA">MA</option>
                                <option value="MT">MT</option>
                                <option value="MS">MS</option>
                                <option value="MG">MG</option>
                                <option value="PA">PA</option>
                                <option value="PB">PB</option>
                                <option value="PR">PR</option>
                                <option value="PE">PE</option>
                                <option value="PI">PI</option>
                                <option value="RJ">RJ</option>
                                <option value="RN">RN</option>
                                <option value="RS">RS</option>
                                <option value="RO">RO</option>
                                <option value="RR">RR</option>
                                <option value="SC">SC</option>
                                <option value="SP">SP</option>
                                <option value="SE">SE</option>
                                <option value="TO">TO</option>
                            </select>
                        </div>
                    </li>
                    
                </ul>
                <div class="perfil-descricao">
                    <h4>Descri√ß√£o:</h4>
                    <p id="descricaoPerfil">...</p>
                    <textarea id="inputDescricao" class="input-edicao oculto" placeholder="Sua descri√ß√£o..."></textarea>
                </div>
            </div>

            <!-- üÜï NOVO: Bot√£o de Disponibilidade (apenas para profissionais) -->
            <div id="disponibilidade-container" class="disponibilidade-container" style="display: none;">
                <label class="switch disponibilidade-switch">
                    <input type="checkbox" id="toggle-disponibilidade">
                    <span class="slider round"></span>
                </label>
                <span id="disponibilidade-texto">Dispon√≠vel agora</span>
            </div>

            <div class="perfil-footer">
                <button id="editarPerfilBtn" class="edit-btn" style="display: none;">Editar Perfil</button>
                <div class="botoes-edicao oculto">
                    <!-- üõë ATUALIZA√á√ÉO: Bot√£o Salvar com Spinner -->
                    <button id="btnSalvarPerfil" class="salvar-btn">
                        <span class="btn-text">Salvar</span>
                        <span class="btn-spinner oculto"></span>
                    </button>
                    <button id="btnCancelarEdicao" class="cancelar-btn">Cancelar</button>
                </div>
            </div>
        </div>
        
        <!-- ... (Restante do HTML de perfil.html sem altera√ß√£o) ... -->
        <div class="perfil-acoes">
            <button id="mostrarServicosBtn" class="perfil-btn ativo" style="display: none;">Projetos</button>
            <button id="mostrarPostagensBtn" class="perfil-btn">Postagens</button>
        </div>
        <div id="secao-servicos" class="secao-perfil ativa" style="display: none;">
            <div class="servicos-header">
                <h3>Projetos</h3>
                <button id="addServicoBtn" class="add-btn" style="display: none;">Adicionar Projeto</button>
                <input type="file" id="inputFotoServico" accept="image/*,video/*" multiple style="display: none;">
            </div>
            <div id="galeriaServicos" class="galeria-servicos"></div>
        </div>
        
        <!-- üÜï NOVO: Modal de Pr√©-visualiza√ß√£o da Foto de Perfil -->
        <div id="modal-preview-avatar" class="modal-overlay hidden">
            <div class="modal-content modal-preview-avatar">
                <h3>Pr√©-visualizar foto de perfil</h3>
                <p style="margin-bottom: 10px; color: var(--text-secondary); font-size: 14px;">
                    Arraste a imagem dentro do c√≠rculo para ajustar o enquadramento.
                </p>
                <div id="avatar-preview-area" class="avatar-preview-area">
                    <img id="avatar-preview-img" src="" alt="Pr√©-visualiza√ß√£o da foto">
                </div>
                <div class="modal-buttons">
                    <button type="button" id="avatar-preview-cancel" class="btn-secondary">Cancelar</button>
                    <button type="button" id="avatar-preview-save" class="btn-primary">Salvar foto</button>
                </div>
            </div>
        </div>

        <!-- üÜï NOVO: Modal para validar projeto -->
        <div id="modal-validar-projeto" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-shield-alt"></i> Validar Projeto</h3>
                    <button class="btn-close-modal" data-modal="modal-validar-projeto">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="form-validar-projeto">
                        <div class="form-group">
                            <label>Coment√°rio sobre a valida√ß√£o (opcional)</label>
                            <textarea id="comentario-validacao" placeholder="Deixe um coment√°rio sobre por que voc√™ est√° validando este projeto..." rows="4"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">üõ°Ô∏è Validar Projeto</button>
                            <button type="button" class="btn-secondary btn-close-modal" data-modal="modal-validar-projeto">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- üÜï NOVO: Modal para adicionar projeto ao portf√≥lio -->
        <div id="modal-adicionar-projeto" class="modal-overlay hidden">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3><i class="fas fa-folder-plus"></i> Adicionar Projeto ao Portf√≥lio</h3>
                    <button class="btn-close-modal" data-modal="modal-adicionar-projeto">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="form-adicionar-projeto">
                        <div class="form-group">
                            <label>T√≠tulo do Projeto</label>
                            <input type="text" id="projeto-titulo" required placeholder="Ex: Site da Padaria X">
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <textarea id="projeto-descricao" required placeholder="Descreva o projeto..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Desafio Enfrentado</label>
                            <textarea id="projeto-desafio" placeholder="Qual foi o desafio principal deste projeto?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Tecnologias/Habilidades Usadas</label>
                            <input type="text" id="projeto-tecnologias" placeholder="Ex: JavaScript, React, Node.js (separadas por v√≠rgula)">
                        </div>
                        <div class="form-group">
                            <label>Fotos/V√≠deos do Projeto</label>
                            <div class="projeto-upload-wrapper">
                                <button type="button" id="projeto-upload-btn" class="btn-secondary btn-upload-midia">
                                    Adicionar fotos/v√≠deos
                                </button>
                                <input type="file" id="projeto-imagens" accept="image/*,video/*" multiple style="display: none;">
                            </div>
                            <div id="projeto-contador-midia" class="projeto-contador-midia oculto">0/5</div>
                            <div id="projeto-preview-container" class="projeto-preview-container"></div>
                        </div>
                        <div class="form-group">
                            <label>Desafio Helpy (opcional)</label>
                            <input
                                type="text"
                                id="projeto-tag-desafio"
                                placeholder="Se fizer parte de um Desafio Helpy, escreva aqui o nome ou hashtag"
                            >
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">Adicionar Projeto</button>
                            <button type="button" class="btn-secondary btn-close-modal" data-modal="modal-adicionar-projeto">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div id="secao-postagens" class="secao-perfil">
            <h3>Minhas Postagens</h3>
            <div id="minhasPostagens" class="minhas-postagens"></div>
        </div>
        <!-- üåü NOVO: Se√ß√£o de Avalia√ß√µes Verificadas -->
        <div id="secao-avaliacoes-verificadas" class="secao-perfil" style="display: none;">
            <h3>
                <i class="fas fa-star" style="color: #ffc107;"></i> 
                Avalia√ß√µes Verificadas 
                <span class="badge-verificado" style="background: #28a745; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 10px;">
                    <i class="fas fa-check-circle"></i> Cliente Verificado
                </span>
            </h3>
            <div id="lista-avaliacoes-verificadas" class="lista-avaliacoes"></div>
        </div>

        <div id="secao-avaliacao" class="secao-perfil" style="display: none;">
            <h3>Deixe sua Avalia√ß√£o</h3>
            <form id="formAvaliacao">
                <div id="estrelas-avaliacao-input" class="estrelas">
                    <span data-value="1"><i class="far fa-star"></i></span>
                    <span data-value="2"><i class="far fa-star"></i></span>
                    <span data-value="3"><i class="far fa-star"></i></span>
                    <span data-value="4"><i class="far fa-star"></i></span>
                    <span data-value="5"><i class="far fa-star"></i></span>
                </div>
                <p id="notaSelecionada"></p>
                <textarea id="comentarioAvaliacaoInput" placeholder="Escreva um coment√°rio sobre o servi√ßo..."></textarea>
                <button id="btnEnviarAvaliacao" class="salvar-btn" type="submit">Enviar Avalia√ß√£o</button>
            </form>
        </div>
    </div>
    <div id="logout-confirm-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Tem certeza que deseja sair?</h3>
            <div class="modal-buttons">
                <button id="confirm-logout-yes" class="btn-confirm-yes">Sim</button>
                <button id="confirm-logout-no" class="btn-confirm-no">N√£o</button>
            </div>
        </div>
    </div>
    <div id="image-modal" class="image-modal-overlay">
        <span id="close-image-modal" class="close-btn-modal">&times;</span>
        <img id="modal-image" class="image-modal-content" src="" alt="Imagem Ampliada">
    </div>
    <script src="/perfil.js"></script>
</body>
</html>

